<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Peter Wooldridge's Blog</title><link href="https://peterwooldridge.me/" rel="alternate"></link><link href="https://peterwooldridge.me/feeds/all.atom.xml" rel="self"></link><id>https://peterwooldridge.me/</id><updated>2021-01-31T12:15:00+00:00</updated><subtitle>I'm a Data Scientist with Type 1 Diabetes. Most of the time I'll write about one or the other.</subtitle><entry><title>The single UNIX setting that always saves me time</title><link href="https://peterwooldridge.me/unix_efficiency.html" rel="alternate"></link><published>2021-01-31T12:15:00+00:00</published><updated>2021-01-31T12:15:00+00:00</updated><author><name>Peter Wooldridge</name></author><id>tag:peterwooldridge.me,2021-01-31:/unix_efficiency.html</id><summary type="html">&lt;p&gt;Anyone who spends a lot of time on the command line will know the frustration of trying to locate a previous command from your bash history. The following configuration allows a simple one button ability to search through your bash history using the up and down arrows. Unlike other approaches …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Anyone who spends a lot of time on the command line will know the frustration of trying to locate a previous command from your bash history. The following configuration allows a simple one button ability to search through your bash history using the up and down arrows. Unlike other approaches like CTRL-R, which search the history for a substring anywhere in the command, this method will search the history using the text to the left of the cursor. So, if I type &lt;code&gt;ls&lt;/code&gt; and then up I will cycle through the most recent commands starting with &lt;code&gt;ls&lt;/code&gt;. I personally find this makes it a much faster way to locate previous commands. To set it, simply add the following lines to ~/.inputrc:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\e[A&amp;quot;&lt;/span&gt;: history-search-backward
&lt;span class="s2"&gt;&amp;quot;\e[B&amp;quot;&lt;/span&gt;: history-search-forward
&lt;/pre&gt;&lt;/div&gt;
</content></entry><entry><title>Support Vector Machines (Part 1)</title><link href="https://peterwooldridge.me/svm_1.html" rel="alternate"></link><published>2019-09-04T11:56:00+01:00</published><updated>2019-09-04T11:56:00+01:00</updated><author><name>Peter Wooldridge</name></author><id>tag:peterwooldridge.me,2019-09-04:/svm_1.html</id><summary type="html">&lt;p&gt;Support Vector Machines (SVMs) are a versatile classification algorithm that should be a staple in every data scientists toolbox. In this first of a series of posts, my goal is to describe the intuition behind SVMs what makes them such a powerful technique for classification.&lt;/p&gt;
&lt;p&gt;Suppose we want to classify …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Support Vector Machines (SVMs) are a versatile classification algorithm that should be a staple in every data scientists toolbox. In this first of a series of posts, my goal is to describe the intuition behind SVMs what makes them such a powerful technique for classification.&lt;/p&gt;
&lt;p&gt;Suppose we want to classify the red dots from the blue in the figure below. Plotted on the axes are an orange, black and green hyperplane. All three perfectly separate the red and blue classes. So which one is the best choice to split our data?&lt;/p&gt;
&lt;p align="center"&gt;
   &lt;img src="images/multiple_hyperplanes.png" alt="drawing" width="500"/&gt;  
&lt;/p&gt;

&lt;p&gt;The hardest points to classify are those sat closest to the hyperplane. Therefore, a decision boundary that creates a large gap between the classes is preferable because new data points are more likely to be correctly classified. The SVM defines this criterion as finding a decision boundary that is maximally far away from any data point. The distance between the decision boundary and the closest data point determines the margin of the classifier.&lt;/p&gt;
&lt;p&gt;The figure below shows the data being separated by the largest margin decision boundary. The maximum margin decision boundary is defined by two parallel hyperplanes, one that goes through the positive data points closest to the decision boundary and one that goes through the negative points closest to the decision boundary. These are known as the support vectors.&lt;/p&gt;
&lt;p align="center"&gt;
   &lt;img src="images/maximal_margin.png" alt="Drawing" width="500"/&gt;
&lt;/p&gt;

&lt;p&gt;Mathematically, we can summarise what we have described so far.&lt;/p&gt;
&lt;p&gt;Suppose we are given $N$ training vectors ${(x^{(i)}, y^{(i)}); i=0, \dots, N}, \text{ where } x ∈ \mathbb{R}^{D}, y ∈ {−1, 1}$. We want to learn a set of weights $w$ and $b$ such that the linear combination of weights and input data predicts the value of y.&lt;/p&gt;
&lt;p&gt;$$
h_{w,b}(x) =
     \begin{cases}
       1 &amp;amp;\quad\text{if }w^{T} x + b &amp;gt;= 0\
       -1 &amp;amp;\quad\text{otherwise}
     \end{cases}
$$&lt;/p&gt;
&lt;p&gt;In the two dimensional case, our decision boundary $w^{T} x + b = 0$ is simply a line with the regions above and below it represented by $w^{T}x + b &amp;gt; 0$ and $w^{T}x + b &amp;lt; 0$.&lt;/p&gt;
&lt;p align="center"&gt;
   &lt;img src="images/decision_boundary.png" alt="Drawing" width="500"/&gt;
&lt;/p&gt;

&lt;h3&gt;Distance between points and the hyperplane&lt;/h3&gt;
&lt;p&gt;We know that we want to find the values of $w$ and $b$ that provide the widest margin. Therefore, we need a way to measure the distance between a given point and the hyperplane. Let's define $\gamma^{(i)}$ to be the distance between the $i^{th}$ training observation $x^{(i)}$ and our hyperplane.&lt;/p&gt;
&lt;p&gt;Consider the decision boundary shown in the figure below. If we define $x_{0}$ to be a vector on the hyperplane. Then the $x^{(i)} - x_{0}$ represents a vector from $x^{(i)}$ to the hyperplane. The dotted black line from $x^{(i)}$ to the hyperplane represents the vector whose distance is the shortest to the hyperplane. This dotted line forms a right-angled triangle with the hyperplane and we can label the unknown angle at the top of our triangle $\theta$. The vector $w^{*}$ represents the unit vector perpendicular to the hyperplane.&lt;/p&gt;
&lt;p align="center"&gt;
   &lt;img src="images/svm_distance_to_hyperplane.png" alt="Drawing" width="500"/&gt;
&lt;/p&gt;

&lt;p&gt;Using trigonometry, and setting $f = x^{(i)} - x_{0}$:&lt;/p&gt;
&lt;p&gt;$\cos{\theta} = \dfrac{\text{adjacent}}{\text{hypothenuse}}\
\implies \cos{\theta} = \dfrac{\gamma^{(i)}}{|f|}\
\implies |f|\cos{\theta} = \gamma^{(i)}\
\implies \dfrac{|w^{&lt;em&gt;}|}{|w^{&lt;/em&gt;}|}|f|\cos{\theta} = \gamma^{(i)}\
\implies fw^{*} = \gamma^{(i)}\
\implies \dfrac{(x^{(i)} - x_{0})w}{|w|} = \gamma^{(i)}$&lt;/p&gt;
&lt;p&gt;and then using $wx_{0} = -b$, since $x_{0}$ lies on the hyperplane, we have:&lt;/p&gt;
&lt;p&gt;$\implies \dfrac{wx^{(i)} + b}{|w|} = \gamma^{(i)}$&lt;/p&gt;
&lt;p&gt;We will see below how this distance is used in the definitions of the Functional and Geometric margins defined below.&lt;/p&gt;
&lt;h3&gt;Functional and Geometric Margins&lt;/h3&gt;
&lt;p&gt;Given a training example $(x^{(i)}, y^{(i)})$, we define the functional margin of $(w, b)$ with
respect to a training example as:&lt;/p&gt;
&lt;p&gt;$\hat{\gamma}^{(i)} = y^{(i)}(w^{T} x^{(i)} + b)$&lt;/p&gt;
&lt;p&gt;The functional margin serves as a test function to determine whether a given training point is classified correctly. For a training example to be correctly classified $\hat{\gamma}^{(i)} \geq 0$.&lt;/p&gt;
&lt;p&gt;One problem with the functional margin is that it can be affected by an arbitrary scaling of $w$ and $b$. That brings us onto the definition of the geometric margin:&lt;/p&gt;
&lt;p&gt;$\gamma^{(i)} = \hat{\gamma}^{(i)}/|w|$&lt;/p&gt;
&lt;p&gt;The geometric margin is telling you not only if a point is properly classified or not, but the magnitude of that distance in term of units of |w|. It is invariant to any scaling of $w$ or $b$ which will be important later. The geometric margin should look familiar as the distance between a training point and our hyperplane that we derived in the previous section multiplied by the label $y^{(i)}$.&lt;/p&gt;
&lt;p&gt;Given a training set&lt;/p&gt;
&lt;p&gt;$S = {(x^{(i)}, y^{(i)}); i=1 \dotsc n}$&lt;/p&gt;
&lt;p&gt;we define the geometric margin of $(w,b)$ with respect to $S$ to be the smallest of the geometric margins on the individual training examples:&lt;/p&gt;
&lt;p&gt;$\gamma = \min_{i=1 \dotsc n} \gamma ^ {(i)}$&lt;/p&gt;
&lt;h3&gt;The optimal margin classifier&lt;/h3&gt;
&lt;p&gt;In order to find the widest margin classifier, we want to maximise the geometric margin whilst still correctly classifying all our training examples. This can be formulated as the following optimisation problem:&lt;/p&gt;
&lt;p&gt;$\max_{w, b} \gamma \quad$ s.t. $\quad \dfrac{y^{(i)}(w^{T} x^{(i)} + b)}{|w|}\geq \gamma \text{ for } i=1 \dotsc n$&lt;/p&gt;
&lt;p&gt;It turns out that the above problem is hard to optimise. Therefore, we convert it to any equivalent problem that happends to be easier to solve. For any solution to satisfy the above equation, any positively scaled multiple will also, due to the fact that the geometric margin is invariant to scaling of $w$.&lt;/p&gt;
&lt;p&gt;Therefore, we can scale $w$ in such a way that $|w| = \dfrac{1}{\gamma}$. Also note that maximising $\dfrac{1}{|w|}$ is the same as minimising $|w|$ which is the same as minimising $\dfrac{1}{2}|w|^{2}$.&lt;/p&gt;
&lt;p&gt;Thus, we can reformulate the optimisation problem as:  &lt;/p&gt;
&lt;p&gt;$\min_{w, b} \dfrac{1}{2}|w|^{2} \quad$ s.t. $\quad y^{(i)}(w^{T} x^{(i)} + b)\geq 1 \text{ for } i=1 \dotsc n$&lt;/p&gt;
&lt;p&gt;This optimisation problem is known as a quadratic optimisation problem which is easier to solve. The solution to this optimisation problem will be the topic for a future post.&lt;/p&gt;</content></entry><entry><title>Visualising networks in R using atomic plot functions</title><link href="https://peterwooldridge.me/heatmaps_in_r.html" rel="alternate"></link><published>2017-09-28T21:13:00+01:00</published><updated>2017-09-28T21:13:00+01:00</updated><author><name>Peter Wooldridge</name></author><id>tag:peterwooldridge.me,2017-09-28:/heatmaps_in_r.html</id><summary type="html">&lt;p&gt;One of the most natural ways to visualise a social network is a network diagram which consists of a series of dots representing the entity in the network and lines representing the relationships between the entities. This type of visualisation looks as follows:&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="" src="images/standard-network-plot.png" /&gt;
&lt;/div&gt;
&lt;p&gt;We can encode community information to this …&lt;/p&gt;</summary><content type="html">&lt;p&gt;One of the most natural ways to visualise a social network is a network diagram which consists of a series of dots representing the entity in the network and lines representing the relationships between the entities. This type of visualisation looks as follows:&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="" src="images/standard-network-plot.png" /&gt;
&lt;/div&gt;
&lt;p&gt;We can encode community information to this type of plot by colouring the nodes according to the communitiy memberships.&lt;/p&gt;
&lt;p&gt;As Mike Bostock &lt;a class="reference external" href="https://bost.ocks.org/mike/miserables/"&gt;showed&lt;/a&gt;, another interesting way to visualise a network is with the adjacency matrix. As a reminder the Adjacency matrix is defined as follows:&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;i&gt;A&lt;/i&gt;&lt;sub&gt;&lt;i&gt;ij&lt;/i&gt;&lt;/sub&gt; = &lt;span class="array"&gt;&lt;span class="arrayrow"&gt;&lt;span class="bracket align-left"&gt;⎧&lt;/span&gt;&lt;/span&gt;&lt;span class="arrayrow"&gt;&lt;span class="bracket align-left"&gt;⎨&lt;/span&gt;&lt;/span&gt;&lt;span class="arrayrow"&gt;&lt;span class="bracket align-left"&gt;⎩&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="array"&gt;&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-l"&gt;
1
&lt;/span&gt;
&lt;span class="arraycell align-r"&gt;
 : &lt;span class="text"&gt; if &lt;/span&gt;&lt;i&gt;i&lt;/i&gt;&lt;span class="text"&gt; connected to &lt;/span&gt;&lt;i&gt;j&lt;/i&gt;
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-l"&gt;
0
&lt;/span&gt;
&lt;span class="arraycell align-r"&gt;
 : &lt;span class="text"&gt; otherwise&lt;/span&gt;
&lt;/span&gt;

&lt;/span&gt;
&lt;/span&gt;&lt;span class="emptydot"&gt;&lt;/span&gt;
&lt;/div&gt;
&lt;p&gt;The usefullness of the visualisation of the adjacency matrix depends largely on the order of the rows and columns in the plot. By finding communities in the network, we can reorder the rows and columns of the adjacency matrix accordingly to produce a plot that looks as follows:&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="" src="images/lesmis.png" /&gt;
&lt;/div&gt;
&lt;p&gt;In this post I show how to create the above plot using atomic plot functions in R. The coloured blocks down the diagonal of the plot represent the different communities in the network.&lt;/p&gt;
&lt;p&gt;To get started, the first thing we need is some data in a matrix object. We load the same Les Misérables data as used for the visualisation &lt;a class="reference external" href="https://bost.ocks.org/mike/miserables/"&gt;here&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nf"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;jsonlite&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nf"&gt;library&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;igraph&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;json_data&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;fromJSON&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://bost.ocks.org/mike/miserables/miserables.json&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;fromJSON&lt;/code&gt; function reads the les miserables data into a list containing information about the nodes and edges in the graph. We extract two fields from the list, a vector of character names and the edge data&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;characters&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;json_data[[1]]&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;
&lt;span class="n"&gt;edges&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;json_data[[2]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can view these two objects:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;characters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;[1]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Myriel&amp;quot;&lt;/span&gt;          &lt;span class="s"&gt;&amp;quot;Napoleon&amp;quot;&lt;/span&gt;        &lt;span class="s"&gt;&amp;quot;Mlle.Baptistine&amp;quot;&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Mme.Magloire&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;[5]&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;CountessdeLo&amp;quot;&lt;/span&gt;    &lt;span class="s"&gt;&amp;quot;Geborand&amp;quot;&lt;/span&gt;

&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;
&lt;span class="m"&gt;1&lt;/span&gt;      &lt;span class="m"&gt;1&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt;     &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="m"&gt;2&lt;/span&gt;      &lt;span class="m"&gt;2&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt;     &lt;span class="m"&gt;8&lt;/span&gt;
&lt;span class="m"&gt;3&lt;/span&gt;      &lt;span class="m"&gt;3&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt;    &lt;span class="m"&gt;10&lt;/span&gt;
&lt;span class="m"&gt;4&lt;/span&gt;      &lt;span class="m"&gt;3&lt;/span&gt;      &lt;span class="m"&gt;2&lt;/span&gt;     &lt;span class="m"&gt;6&lt;/span&gt;
&lt;span class="m"&gt;5&lt;/span&gt;      &lt;span class="m"&gt;4&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt;     &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="m"&gt;6&lt;/span&gt;      &lt;span class="m"&gt;5&lt;/span&gt;      &lt;span class="m"&gt;0&lt;/span&gt;     &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;edges&lt;/code&gt; object contains information about which node (source column) is connected to which (target column) and the co-occurence number (value column). This a succint way to represent a matrix as we only have rows for the non-zero matrix elements. Representing a matrix in this way is known as Triplet representation.&lt;/p&gt;
&lt;p&gt;Next, we convert each of the numeric columns of &lt;code&gt;edges&lt;/code&gt; into character names by iterating through each row of &lt;code&gt;edges&lt;/code&gt; and replacing the &lt;code&gt;source&lt;/code&gt; and &lt;code&gt;target&lt;/code&gt; numbers with the name of the character at that index of the characters array. We add one to the index to account for the fact that R indexes from one not zero.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;edges_w_names&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;MARGIN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nf"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;src_idx&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;as.numeric&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x[&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;source&amp;quot;&lt;/span&gt;&lt;span class="n"&gt;]&lt;/span&gt;&lt;span class="m"&gt;+1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;dest_idx&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;as.numeric&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x[&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;target&amp;quot;&lt;/span&gt;&lt;span class="n"&gt;]&lt;/span&gt;&lt;span class="m"&gt;+1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="nf"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;characters[src_idx]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;characters[dest_idx]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x[&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class="n"&gt;]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}))&lt;/span&gt;
&lt;span class="n"&gt;edges_w_names&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;as.data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;stringsAsFactors&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;F&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nf"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;source&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;target&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;as.character&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;as.character&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;as.numeric&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;edges_w_names&lt;/code&gt; is a three column data.frame that looks as follows:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
           &lt;span class="n"&gt;source&lt;/span&gt;          &lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;
&lt;span class="m"&gt;1&lt;/span&gt;        &lt;span class="n"&gt;Napoleon&lt;/span&gt;          &lt;span class="n"&gt;Myriel&lt;/span&gt;     &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="n"&gt;Mlle.Baptistine&lt;/span&gt;          &lt;span class="n"&gt;Myriel&lt;/span&gt;     &lt;span class="m"&gt;8&lt;/span&gt;
&lt;span class="m"&gt;3&lt;/span&gt;    &lt;span class="n"&gt;Mme.Magloire&lt;/span&gt;          &lt;span class="n"&gt;Myriel&lt;/span&gt;    &lt;span class="m"&gt;10&lt;/span&gt;
&lt;span class="m"&gt;4&lt;/span&gt;    &lt;span class="n"&gt;Mme.Magloire&lt;/span&gt; &lt;span class="n"&gt;Mlle.Baptistine&lt;/span&gt;     &lt;span class="m"&gt;6&lt;/span&gt;
&lt;span class="m"&gt;5&lt;/span&gt;    &lt;span class="n"&gt;CountessdeLo&lt;/span&gt;          &lt;span class="n"&gt;Myriel&lt;/span&gt;     &lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="m"&gt;6&lt;/span&gt;        &lt;span class="n"&gt;Geborand&lt;/span&gt;          &lt;span class="n"&gt;Myriel&lt;/span&gt;     &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now we convert from the character name matrix in Triplet representation into a fully dense matrix object. In order to do this we make use of the &lt;code&gt;graph.data.frame&lt;/code&gt; object from the igraph package. The &lt;code&gt;get.adjacency&lt;/code&gt; function is builds a dense matrix from the igraph object. Because the edges in our network are un-directed the adjacency matrix will be a symmetric matrix&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;gdf&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;graph.data.frame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;edges_w_names&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;directed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;F&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;adj_mat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;get.adjacency&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sparse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;value&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now we have the igraph &lt;code&gt;gdf&lt;/code&gt; object, we can use it to detect communities in our network. There are several clustering routines built into igraph. Here we use the &lt;code&gt;cluster_infomap&lt;/code&gt; function which returns amongst other things an object containing membership attributes for each node in the graph&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# cluster graph&lt;/span&gt;
&lt;span class="n"&gt;members&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;igraph&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="nf"&gt;cluster_infomap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdf&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;membership&lt;/span&gt;
&lt;span class="c1"&gt;# how many communities are there&lt;/span&gt;
&lt;span class="n"&gt;n_cluster&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;unique&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;members&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;# reorder accordign to cluster memberships&lt;/span&gt;
&lt;span class="n"&gt;adj_mat&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="nf"&gt;[order&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;members&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nf"&gt;order&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;members&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now we're ready to create the actual plot. I've added comments into the code below to try and better explain what's happening&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# open a png handle&lt;/span&gt;
&lt;span class="nf"&gt;png&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;lesmis.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;7000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;height&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;7000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# set up plot parameters&lt;/span&gt;
&lt;span class="nf"&gt;par&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;black&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;mar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;family&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Roboto Light&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;col.main&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;ps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# create an empty plot (use axis=F so we can customise axis later)&lt;/span&gt;
&lt;span class="nf"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="n"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="n"&gt;xlim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nf"&gt;ncol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
     &lt;span class="n"&gt;ylim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;c&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nf"&gt;ncol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
     &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Les Misérables Co-occurance Matrix&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# define community colours&lt;/span&gt;
&lt;span class="n"&gt;cluster_cols&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;categorical_pal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n_cluster&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# iterate over each row and column of adjacency matrix and draw rectangles onto the plot&lt;/span&gt;
&lt;span class="nf"&gt;lapply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nf"&gt;nrow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nf"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nf"&gt;lapply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nf"&gt;ncol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nf"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;# each entry in matrix is an edge so if communities differ pick the smallest&lt;/span&gt;
    &lt;span class="n"&gt;cluster_no&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;members&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;[j]&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;members&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;[i]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# draw squares on the plot&lt;/span&gt;
    &lt;span class="nf"&gt;rect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="n"&gt;xleft&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="n"&gt;xright&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="m"&gt;.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="n"&gt;ytop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="m"&gt;.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="n"&gt;ybottom&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="m"&gt;.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="n"&gt;pch&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="n"&gt;cex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="n"&gt;col&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nf"&gt;ifelse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat[i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;black&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cluster_cols[cluster_no]&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;)})&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="c1"&gt;# draw the x and y axis with the character names&lt;/span&gt;
&lt;span class="nf"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;side&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;colnames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nf"&gt;nrow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;white&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col.ticks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;white&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col.axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;white&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;las&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cex.axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nf"&gt;axis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;side&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nf"&gt;rownames&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nf"&gt;ncol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;col&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;white&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col.ticks&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;white&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;col.axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;white&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;las&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cex.axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0.2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# add a grid to the plot&lt;/span&gt;
&lt;span class="nf"&gt;abline&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nf"&gt;ncol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nf"&gt;ncol&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adj_mat&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;lty&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# close the plot device (i.e. write the png to disk)&lt;/span&gt;
&lt;span class="nf"&gt;dev.off&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We have shown how using the atomic plot functions in R we can create some nice looking visualisations of network data. The full code is available at &lt;a class="reference external" href="https://github.com/pwwooldridge/les-mis-adjacency-vis"&gt;this github repo&lt;/a&gt;&lt;/p&gt;
</content><category term="R"></category><category term="networks"></category><category term="visualisation"></category></entry><entry><title>Linear Regression from first principles</title><link href="https://peterwooldridge.me/linear_regression.html" rel="alternate"></link><published>2017-09-12T21:46:00+01:00</published><updated>2017-09-12T21:46:00+01:00</updated><author><name>Peter Wooldridge</name></author><id>tag:peterwooldridge.me,2017-09-12:/linear_regression.html</id><summary type="html">&lt;p&gt;Linear regression allows one to model a dependent variable with the best straight line fit to a set of predictor variables. In the simplest scenario we have a single predictor variable. This is called simple linear regression.&lt;/p&gt;
&lt;p&gt;As an example let's take the trees dataset provided by the datasets package …&lt;/p&gt;</summary><content type="html">&lt;p&gt;Linear regression allows one to model a dependent variable with the best straight line fit to a set of predictor variables. In the simplest scenario we have a single predictor variable. This is called simple linear regression.&lt;/p&gt;
&lt;p&gt;As an example let's take the trees dataset provided by the datasets package in R. The data consists of measurements of girth, height and volume of 31 felled black cherry trees. Suppose we wish to try and predict the volume of a black cherry tree from its girth. To begin with we can plot the two variables using the following command:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nf"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Girth&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Volume&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;xlab&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Girth (inches)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ylab&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Volume (cubic feet)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="figure"&gt;
&lt;img alt="" src="https://peterwooldridge.me/tree_girths.png" /&gt;
&lt;/div&gt;
&lt;p&gt;The data certainly looks to have a linear relationship. A straight line equation in 2 dimensions can be defined by two variables namely the slope and intercept. Different choices for these parameters will produce different best fit lines as shown in the plot below:&lt;/p&gt;
&lt;div class="figure"&gt;
&lt;img alt="" src="https://peterwooldridge.me/possible_linear_fits.png" /&gt;
&lt;/div&gt;
&lt;p&gt;The left hand figure above shows linear fits with varying slopes and a fixed intercept. The right hand figure shows linear fits with varying intercepts and constant slopes. We want to find the combination of parameters for which our line best fits the data.&lt;/p&gt;
&lt;p&gt;We'll return back to the trees example but suppose that in general we observe &lt;span class="formula"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/span&gt; pairs of data points &lt;span class="formula"&gt;(&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;, &lt;i&gt;y&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;), (&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt;, &lt;i&gt;y&lt;/i&gt;&lt;sub&gt;2&lt;/sub&gt;), …, (&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sub&gt;, &lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sub&gt;)&lt;/span&gt; for &lt;span class="formula"&gt;&lt;i&gt;i&lt;/i&gt; = 1, 2, …&lt;i&gt;n&lt;/i&gt;&lt;/span&gt;. We can define a linear relationship by writing each observation pair as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class="formula"&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; = &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; + &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt; + &lt;i&gt;ϵ&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;  &lt;i&gt;i&lt;/i&gt; = 1, 2, …&lt;i&gt;n&lt;/i&gt;&lt;span class="unknown"&gt;\tag&lt;/span&gt;2 &lt;a class="eqnumber" name="2"&gt; &lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;&lt;/span&gt; and &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/span&gt; represent the slope and intercept respectively of our straight line fit. The &lt;span class="formula"&gt;&lt;i&gt;ϵ&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt; are called residuals and represent the random variation of the &lt;span class="formula"&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt; around the straight line fit. Thought of another way each &lt;span class="formula"&gt;&lt;i&gt;ϵ&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt; is the error between the true value of our response variable &lt;span class="formula"&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt; and the prediction given by our linear regression.&lt;/p&gt;
&lt;p&gt;We wish to find an intercept/slope &lt;span class="formula"&gt;(&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;, &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;)&lt;/span&gt; combination that minimises the &lt;span class="formula"&gt;&lt;i&gt;ϵ&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt; for &lt;span class="formula"&gt;&lt;i&gt;i&lt;/i&gt; = 1, 2, …&lt;i&gt;n&lt;/i&gt;&lt;/span&gt; meaning that our prediction errors are small. The most popular method of achieving this is to compute the sum of the squares of the residuals for &lt;span class="formula"&gt;&lt;i&gt;i&lt;/i&gt; = 1, 2, …&lt;i&gt;n&lt;/i&gt;&lt;/span&gt; and choose values of &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;&lt;span class="text"&gt;  and &lt;/span&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/span&gt; that minimise this quanity. Mathematically we can write the residual sum of square (RSS) as follows:&lt;/p&gt;
&lt;p&gt;&lt;span class="formula"&gt;&lt;i&gt;RSS&lt;/i&gt; = &lt;span class="limits"&gt;&lt;span class="limit"&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;ϵ&lt;/i&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;2&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;span class="unknown"&gt;\tag&lt;/span&gt;3 &lt;a class="eqnumber" name="3"&gt; &lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;rearranging &lt;span class="formula"&gt;&lt;span class="unknown"&gt;\eqref&lt;/span&gt;2&lt;/span&gt; to make &lt;span class="formula"&gt;&lt;i&gt;ϵ&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt; the subject:&lt;/p&gt;
&lt;p&gt;&lt;span class="formula"&gt;&lt;i&gt;ϵ&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; = &lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;&lt;span class="unknown"&gt;\tag&lt;/span&gt;4 &lt;a class="eqnumber" name="4"&gt; &lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;substituting &lt;span class="formula"&gt;&lt;span class="unknown"&gt;\eqref&lt;/span&gt;4&lt;/span&gt; into &lt;span class="formula"&gt;&lt;span class="unknown"&gt;\eqref&lt;/span&gt;3&lt;/span&gt; we get:&lt;/p&gt;
&lt;p&gt;&lt;span class="formula"&gt;&lt;i&gt;RSS&lt;/i&gt; = &lt;span class="limits"&gt;&lt;span class="limit"&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;)&lt;sup&gt;2&lt;/sup&gt;&lt;span class="unknown"&gt;\tag&lt;/span&gt;5 &lt;a class="eqnumber" name="5"&gt; &lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;To minimise &lt;span class="formula"&gt;&lt;span class="unknown"&gt;\eqref&lt;/span&gt;5&lt;/span&gt; we differentiate &lt;span class="formula"&gt;&lt;i&gt;RSS&lt;/i&gt;&lt;/span&gt; with respect to both &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;&lt;/span&gt; and &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/span&gt; set the resulting quantity equal to zero and solve the two equations.&lt;/p&gt;
&lt;p&gt;We can make use of the chain rule which states that for a composite function of the form:&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="environment"&gt;&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
&lt;i&gt;F&lt;/i&gt;(&lt;i&gt;x&lt;/i&gt;) = &lt;i&gt;f&lt;/i&gt;(&lt;i&gt;g&lt;/i&gt;(&lt;i&gt;x&lt;/i&gt;))
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;

&lt;/span&gt;
&lt;/span&gt;
&lt;/div&gt;
&lt;p&gt;the deriviate is given by&lt;/p&gt;
&lt;p&gt;&lt;span class="formula"&gt;&lt;i&gt;F&lt;/i&gt;’(&lt;i&gt;x&lt;/i&gt;) = &lt;i&gt;f&lt;/i&gt;’(&lt;i&gt;g&lt;/i&gt;(&lt;i&gt;x&lt;/i&gt;))&lt;i&gt;g&lt;/i&gt;’(&lt;i&gt;x&lt;/i&gt;)&lt;span class="unknown"&gt;\tag&lt;/span&gt;6 &lt;a class="eqnumber" name="6"&gt; &lt;/a&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Applying &lt;span class="formula"&gt;&lt;span class="unknown"&gt;\eqref&lt;/span&gt;6&lt;/span&gt; to &lt;span class="formula"&gt;&lt;span class="unknown"&gt;\eqref&lt;/span&gt;5&lt;/span&gt; we get:&lt;/p&gt;
&lt;p&gt;&lt;span class="formula"&gt;&lt;span class="fraction"&gt;&lt;span class="ignored"&gt;(&lt;/span&gt;&lt;span class="numerator"&gt;∂&lt;i&gt;RSS&lt;/i&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)/(&lt;/span&gt;&lt;span class="denominator"&gt;∂&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)&lt;/span&gt;&lt;/span&gt; =  − 2&lt;span class="limits"&gt;&lt;span class="limit"&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;) &lt;a class="eqnumber" name="7"&gt; &lt;/a&gt;&lt;span class="unknown"&gt;\tag&lt;/span&gt;7&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class="formula"&gt;&lt;span class="fraction"&gt;&lt;span class="ignored"&gt;(&lt;/span&gt;&lt;span class="numerator"&gt;∂&lt;i&gt;RSS&lt;/i&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)/(&lt;/span&gt;&lt;span class="denominator"&gt;∂&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)&lt;/span&gt;&lt;/span&gt; =  − 2&lt;span class="limits"&gt;&lt;span class="limit"&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;) &lt;a class="eqnumber" name="8"&gt; &lt;/a&gt;&lt;span class="unknown"&gt;\tag&lt;/span&gt;8&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;We set the above equations equal to zero and solve for &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;&lt;/span&gt; and &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/span&gt; to find the minima. Starting with &lt;span class="formula"&gt;&lt;span class="unknown"&gt;\eqref&lt;/span&gt;7&lt;/span&gt;:&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="environment"&gt;&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
0 =  − 2&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;)
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
0 = &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;)
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
0 = &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 0&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;n&lt;/i&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
&lt;i&gt;n&lt;/i&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt; = &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;
&lt;/span&gt;

&lt;/span&gt;
&lt;/span&gt;
&lt;/div&gt;
&lt;p&gt;making use of &lt;span class="formula"&gt;&lt;span class="bar"&gt;&lt;i&gt;x&lt;/i&gt;&lt;/span&gt; = &lt;span class="fraction"&gt;&lt;span class="ignored"&gt;(&lt;/span&gt;&lt;span class="numerator"&gt;&lt;span class="limits"&gt;&lt;span class="limit"&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)/(&lt;/span&gt;&lt;span class="denominator"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt; and &lt;span class="formula"&gt;&lt;span class="bar"&gt;&lt;i&gt;y&lt;/i&gt;&lt;/span&gt; = &lt;span class="fraction"&gt;&lt;span class="ignored"&gt;(&lt;/span&gt;&lt;span class="numerator"&gt;&lt;span class="limits"&gt;&lt;span class="limit"&gt;∑&lt;/span&gt;&lt;/span&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)/(&lt;/span&gt;&lt;span class="denominator"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;:&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="environment"&gt;&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt; = &lt;span class="bar"&gt;&lt;i&gt;y&lt;/i&gt;&lt;/span&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;span class="bar"&gt;&lt;i&gt;x&lt;/i&gt;&lt;/span&gt;&lt;a class="eqnumber" name="9"&gt; &lt;/a&gt;&lt;span class="unknown"&gt;\tag&lt;/span&gt;9
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;

&lt;/span&gt;
&lt;/span&gt;
&lt;/div&gt;
&lt;p&gt;Now we repeat the same process for &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/span&gt;:&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="environment"&gt;&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
0 =  − 2&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;)
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
0 = &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;)
&lt;/span&gt;

&lt;/span&gt;
&lt;/span&gt;
&lt;/div&gt;
&lt;p&gt;substituting in the value for &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;&lt;/span&gt; obtained in &lt;span class="formula"&gt;&lt;span class="unknown"&gt;\eqref&lt;/span&gt;9&lt;/span&gt;:&lt;/p&gt;
&lt;div class="formula"&gt;
&lt;span class="environment"&gt;&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
0 =  − 2&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;span class="bar"&gt;&lt;i&gt;y&lt;/i&gt;&lt;/span&gt; + &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;span class="bar"&gt;&lt;i&gt;x&lt;/i&gt;&lt;/span&gt;)
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
0 = &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;span class="bar"&gt;&lt;i&gt;y&lt;/i&gt;&lt;/span&gt;) + &lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;(&lt;span class="bar"&gt;&lt;i&gt;x&lt;/i&gt;&lt;/span&gt; − &lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;)
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt; = &lt;span class="fraction"&gt;&lt;span class="ignored"&gt;(&lt;/span&gt;&lt;span class="numerator"&gt; − &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;(&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;span class="bar"&gt;&lt;i&gt;y&lt;/i&gt;&lt;/span&gt;)&lt;/span&gt;&lt;span class="ignored"&gt;)/(&lt;/span&gt;&lt;span class="denominator"&gt;&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;(&lt;span class="bar"&gt;&lt;i&gt;x&lt;/i&gt;&lt;/span&gt; − &lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;)&lt;/span&gt;&lt;span class="ignored"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt; = &lt;span class="fraction"&gt;&lt;span class="ignored"&gt;(&lt;/span&gt;&lt;span class="numerator"&gt; − &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;(&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;span class="bar"&gt;&lt;i&gt;y&lt;/i&gt;&lt;/span&gt;)&lt;/span&gt;&lt;span class="ignored"&gt;)/(&lt;/span&gt;&lt;span class="denominator"&gt;&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;(&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;span class="bar"&gt;&lt;i&gt;x&lt;/i&gt;&lt;/span&gt; − &lt;i&gt;x&lt;/i&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;2&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;)&lt;/span&gt;&lt;span class="ignored"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt; = &lt;span class="fraction"&gt;&lt;span class="ignored"&gt;(&lt;/span&gt;&lt;span class="numerator"&gt;&lt;span class="bar"&gt;&lt;i&gt;y&lt;/i&gt;&lt;/span&gt;&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;N&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)/(&lt;/span&gt;&lt;span class="denominator"&gt;&lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt; − &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;2&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;
 
&lt;/span&gt;

&lt;/span&gt;
&lt;span class="arrayrow"&gt;
&lt;span class="arraycell align-r"&gt;

&lt;/span&gt;
&lt;span class="arraycell align-l"&gt;
&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt; = &lt;span class="fraction"&gt;&lt;span class="ignored"&gt;(&lt;/span&gt;&lt;span class="numerator"&gt;&lt;i&gt;n&lt;/i&gt;&lt;span class="bar"&gt;&lt;i&gt;x&lt;/i&gt;&lt;/span&gt;&lt;span class="bar"&gt;&lt;i&gt;y&lt;/i&gt;&lt;/span&gt; − &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;i&gt;y&lt;/i&gt;&lt;sub&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)/(&lt;/span&gt;&lt;span class="denominator"&gt;&lt;i&gt;n&lt;/i&gt;&lt;span class="bar"&gt;&lt;i&gt;x&lt;/i&gt;&lt;/span&gt;&lt;sup&gt;2&lt;/sup&gt; − &lt;span class="limits"&gt;&lt;sup class="limit"&gt;&lt;i&gt;n&lt;/i&gt;&lt;/sup&gt;&lt;span class="limit"&gt;⎲&lt;/span&gt;&lt;span class="limit"&gt;⎳&lt;/span&gt;&lt;sub class="limit"&gt;&lt;i&gt;i&lt;/i&gt; = 1&lt;/sub&gt;&lt;/span&gt;&lt;i&gt;x&lt;/i&gt;&lt;span class="scripts"&gt;&lt;sup class="script"&gt;2&lt;/sup&gt;&lt;sub class="script"&gt;&lt;i&gt;i&lt;/i&gt;&lt;/sub&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="ignored"&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;/span&gt;

&lt;/span&gt;
&lt;/span&gt;
&lt;/div&gt;
&lt;p&gt;We have now derived least squares estimates for &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;0&lt;/sub&gt;&lt;/span&gt; and &lt;span class="formula"&gt;&lt;i&gt;β&lt;/i&gt;&lt;sub&gt;1&lt;/sub&gt;&lt;/span&gt; using simple linear regression. Armed with these we can generate parameter estimates for the cherry tree regression:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;nrow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;x_bar&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Girth&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;y_bar&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Volume&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;xi_yi_sum&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Girth&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Volume&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;xi_squared_sum&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Girth&lt;/span&gt; &lt;span class="n"&gt;^&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;beta_1&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;x_bar&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;y_bar&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi_yi_sum&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;x_bar^2&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;xi_squared_sum&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;beta_0&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;y_bar&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;beta_1&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;x_bar&lt;/span&gt;

&lt;span class="n"&gt;beta_1&lt;/span&gt;
&lt;span class="n"&gt;[1]&lt;/span&gt; &lt;span class="m"&gt;5.065856&lt;/span&gt;
&lt;span class="n"&gt;beta_0&lt;/span&gt;
&lt;span class="n"&gt;[1]&lt;/span&gt; &lt;span class="m"&gt;-36.94346&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ofcourse R has a built in function (lm) to build a linear regression. We can use this function to compare the estimates we produced above:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;fit&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nf"&gt;lm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Volume&lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Girth&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="nf"&gt;coefficients&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Intercept&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="n"&gt;trees&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;Girth&lt;/span&gt;
&lt;span class="m"&gt;-36.943459&lt;/span&gt;    &lt;span class="m"&gt;5.065856&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;which match our derived estimates.&lt;/p&gt;
</content><category term="linear models"></category><category term="R"></category></entry><entry><title>JOGLE in 106 hours</title><link href="https://peterwooldridge.me/jogle_in_106.html" rel="alternate"></link><published>2016-11-03T11:41:00+00:00</published><updated>2016-11-03T11:41:00+00:00</updated><author><name>Peter Wooldridge</name></author><id>tag:peterwooldridge.me,2016-11-03:/jogle_in_106.html</id><summary type="html">&lt;div class="section" id="day-1-john-o-groats-to-fort-william"&gt;
&lt;h2&gt;Day 1 : John O' Groats to Fort William&lt;/h2&gt;
&lt;div class="figure align-center" style="width: 90%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/screen-shot-2016-11-04-at-10-32-501.png" /&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After a long long drive for the support crew from Plymouth. Pete and I met the campervan at Stockport, loaded kit and bikes onto rack, and we were en route to John O'Groats. We departed Stockport at 18:30. I offered …&lt;/p&gt;&lt;/div&gt;</summary><content type="html">&lt;div class="section" id="day-1-john-o-groats-to-fort-william"&gt;
&lt;h2&gt;Day 1 : John O' Groats to Fort William&lt;/h2&gt;
&lt;div class="figure align-center" style="width: 90%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/screen-shot-2016-11-04-at-10-32-501.png" /&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After a long long drive for the support crew from Plymouth. Pete and I met the campervan at Stockport, loaded kit and bikes onto rack, and we were en route to John O'Groats. We departed Stockport at 18:30. I offered to do the first stint of driving up to the Highlands and my parents would drive the remainder.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Fully aware of what the next few days was going to entail, we both attempted to get some sleep during the latter part of the drive. Sleep however proved almost impossible as the Scottish roads became windier and windier as we pushed further north. It wasn’t until hearing the final pull of the handbrake, a quick check of the watch (05:00am), that we could afford ourselves 3 hour kip before the big start.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We awoke to a wild and windy day on the most north easterly tip of the U.K. - one assumes standard weather in these parts! A fair amount of faff ensued getting the bikes and kit ready for our first outing. Once kitted out, we left John O'Groats at 0906, glad to be out on the bikes after a long journey and starting to make a dent into the 847 miles that lay before us.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Our target was 4 full days (96 hours) which would have us reach Lands End by 0906 on Thursday. We’d calculated that in order to complete this and afford ourselves 6, 4 and 4 hours sleep on each of the respective nights, we’d need to hold 15mph average on the flats and 13mph avg on the hills.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2397-jpg2.png" /&gt;
&lt;p class="caption"&gt;Token signpost photo at John O'Groats before we set off&lt;/p&gt;
&lt;/div&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2399-jpg2.png" /&gt;
&lt;p class="caption"&gt;We're off...&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;The strong north easterly breeze off the North Sea varied between a cross and tailwind as we snaked southwards along the impressive east Scottish coastline. The roads were quiet, good condition and a mixture between fast flat sections and the odd massive hill!&lt;/p&gt;
&lt;p&gt;As we progressed down the coast, a huge swell approached battering the steep cliffs along the A9 bringing with it short but punchy rain shower - a little taster of things to come!&lt;/p&gt;
&lt;p&gt;With all best intentions to keep to our 15mph average, the tail wind was too tempting and we sped along the coast like a freight train. Jon's Garmin computer, our pacemaker for the journey, on battery saving mode to ensure it would last for up to 20 hours of riding kept us oblivious to our over ambitious start. Our first lunch stop, 60 miles in, at a layby overlooking the coastline, gave us a chance to check the average speed which was now pushing 17mph - we both agreed to try and calm down the pace if our legs were to have any chance of seeing through the remaining 814 miles.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 50%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img-20161015-wa0001-jpg.png" /&gt;
&lt;p class="caption"&gt;Oh dear - it was going to be a bit damp&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We continued to make good time, arriving into Inverness on schedule for our dinner break before pushing on along Loch Ness through the night to reach Fort William by midnight. The cold temperatures had caused my iPhone to fail so we couldn't get in touch with HQ. We rode for another 8 miles to the agreed camping spot, but there was no van to be seen! They had set up camp in Fort William, metres away from the point we stopped to try and call them. A rude awakening for the support crew as we continued to ride until they caught up with us again at around 1am. Into the van to warm up, gulp a protein shake, foam roller the quads and jump into bed for a few hours before getting ready to go again the next day.&lt;/p&gt;
&lt;p&gt;Leg 1 complete 194 miles in 15 hours 24 mins. Average speed: 15.7mph&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="day-2-fort-william-to-lockerbie"&gt;
&lt;h2&gt;Day 2 Fort William to Lockerbie&lt;/h2&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/screen-shot-2016-11-04-at-10-33-411.png" /&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A quick breakfast followed by a kit check and we were on the road again by 9, both looking forward to the most spectacular leg of cycling - the scenic climb up to Glencoe followed by a course through the Highlands. The initial climb didn't disappoint. Calm conditions and a great road surface, we made it to the top feeling fresher than expected.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2402-jpg2.png" /&gt;
&lt;p class="caption"&gt;Pete midway up Glencoe, before the heavens opened&lt;/p&gt;
&lt;/div&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_20161017_090210957_hdr-jpg.png" /&gt;
&lt;p class="caption"&gt;Jon and the waterfalls of Glencoe&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;With less than a few minutes to enjoy the spectacular view at the top of Glencoe, ominous skies began to loom ahead. The storm brought with it a punishing headwind and torrential rain that forced us to endure several hours of the worst cycling conditions either had ever ridden in. Trucks travelling in the other direction to us brought with them a jet of icy water to the face, not to mention the gusts of wind that destabilised the bikes.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The rain was so bad that the lining in my helmet disintegrated, pouring a liquid mush of glue and years of helmet sweat into my eyes making them scream! The glue blindness plus rain pouring over my glasses made me effectively blind on the busy A82! Thankfully our agreed lunch spot wasn't too far away, the famous ‘Green Welly Stop' in Tyndrum, near Crinlarich.&lt;/p&gt;
&lt;p&gt;Before looking twice at the roaring log burner, adjacent to the busy restaurant, we had both stripped down to our base layers, removing everything possible including shoes and socks in an attempt to dry our sodden clothes taken to much amusement of the restaurant guests. A mixture of Scottish Cullen Skink and Scottish fry ups consumed before the support van turned up with some dry socks!&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_20161017_105510829-jpg.png" /&gt;
&lt;p class="caption"&gt;Drying our sodden kit on the Green Wellies log burner&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;We maintained a good pace heading south towards the beautiful Loch Lomond as the rain subsided for a short time. This was short lived however as the descent into Dumbarton saw us once again saturated. We met the van for a quick pit stop at the station. Just before turning in, I spotted my friends Kris and wife Laura who live in nearby Helensburgh. Kris was hanging out of his car window as they drove by to ensure that we wouldn’t miss him! Kris and Laura joined us in the van for a tea and cake break, which was a great boost! After the refuel we headed off towards Glasgow.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2407-jpg.png" /&gt;
&lt;p class="caption"&gt;Kris and Laura after our cake stop in Dumbarton&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Navigating a city centre is always tricky. Thankfully my Garmin, despite some teething issues, actually managed to navigate us through the city centre in rush hour without much drama. The roads were surprisingly quiet but the sheer number of traffic lights (must have been about 50) meant a frustrating stop start ride for over an hour which took its toll on our average pace.&lt;/p&gt;
&lt;p&gt;With Glasgow behind us, we believed the most troublesome navigation was done for a good while. How wrong we were. A wrong turn in Hamilton, south of Glasgow, would force us to join a busy 3 lane dual carriageway, before peeling off on a 7 mile divert along the Clyde to finally join up with our original route just 2 miles from the junction we missed back in Hamilton. To add insult to injury, the diversion was also full of steep inclines, some of which were made up of slippery wet cobble stones! Today was not going to plan, we were behind schedule now and our target destination of Carlisle was looking far from achievable.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img-20161021-wa0002-jpg.png" /&gt;
&lt;p class="caption"&gt;The extent of our navigational woes in Hamilton!&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;We continued riding till 1am and stopped for a few hours rest till morning in a layby near Lockerbie.&lt;/p&gt;
&lt;p&gt;Day 2 complete a below target 164 miles completed in 18 hours and 5 mins. Average speed - 12.4. &amp;nbsp;Oh dear!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="day-3-lockerbie-to-crewe"&gt;
&lt;h2&gt;Day 3 Lockerbie to Crewe&lt;/h2&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/screen-shot-2016-11-04-at-10-34-111.png" /&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Our parking spot for the night, situated on the ‘quiet’ B7076, left a lot to be desired. The B7076 runs along the M74 motorway, and is primarily used only for local traffic and for long distance lorry drivers pulling over for the night. At 4am a relentless charge of lorries set off one after the other. Every few minutes the camper would be violently shaken as articulated lorries flew passed at high speed just feet away from the van. An awful nights sleep was had by all!&lt;/p&gt;
&lt;p&gt;We had originally planned to meet my friends from Manchester in Lancaster at 9, but we were now severely behind schedule. We re-arranged the meeting point to Penrith and set off trying to make it there in time to meet their train at 11am. The morning was chilly but the sun was shining as we sped towards Gretna Green.&lt;/p&gt;
&lt;p&gt;As we approached the Lake District the terrain naturally became a bit tougher and the weather unleashed it's worst yet again. We arrived into Penrith in monsoonal conditions to find James and Brendan sheltering in the van with my&amp;nbsp;parents. A very extended lunch break put us further behind our 4 day schedule as we waited for the rain to ease. We gave up waiting and headed out into the storm, naturally 10 minutes later the rain cleared up! We soon found ourselves on an awesome climb up to the top of Shap peak at 1400 feet on the edge of the Lake District, a stunning descent into Kendal followed.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_20161018_144728101-jpg.png" /&gt;
&lt;p class="caption"&gt;Welcome company of James and Brendan at the top of Shap&lt;/p&gt;
&lt;/div&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_20161018_144722673-jpg.png" /&gt;
&lt;p class="caption"&gt;Shap&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Today&amp;nbsp;began with Jon entering the van with the words &amp;quot;I've got some great news, you've got a puncture&amp;quot;. Fortunately, a quick tube change ensued and we were only delayed by 12 minutes or so.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2412-jpg.png" /&gt;
&lt;p class="caption"&gt;Changing the first puncture on the 'quiet' B7076&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;It was a beautiful crisp morning as we set off from Lockerbie. The sun on our faces&amp;nbsp;was&amp;nbsp;invigorating as we sped towards the border. Within a few hours we’d reached Gretna Green and crossed over to England by 11am. Road signs began to appear with ‘The South’ on them, providing a huge mental boost.&lt;/p&gt;
&lt;p&gt;By lunch the weather had turned and we arrived to our lunch stop in Penrith, water logged. There was no point changing clothes as the rain persisted throughout lunch and after we set off. I attempted to wring out my neoprene gloves, but it made little difference. For the first 10 miles post lunch I was shivering. Once the hills of the Lake District were in sight the rain eased and I finally started to warm up. The biggest climb of the day was up Shap. The long hills always provided the temptation to jump out the saddle in order to climb more aggressively but this also used up a lot more energy so I forced myself to stay in the saddle and keep to the small gears. After the climb we had one of the most scenic descents down into Kendal.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After the lakes, we joined the fast and flat(ish) section of the A6 between Kendal and Preston and stormed along in a racing formation with James and Brendan powering on the front Pete and I sat at the back taking advantage of some drafting allowing us to make up some time whilst preserving the legs as much as possible. As was becoming the norm for us by now, the heavens opened about 5 miles from our meeting point with the support van. Once again we would arrive sopping wet. A lovely meal provided by Chris and Vida for the 4 cyclists and another hour or so waiting for the rain to pass. The Manchester boys headed off to the train station whilst we waited till 9pm for the rain to stop before hitting the A6 south again.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2417-jpg.png" /&gt;
&lt;p class="caption"&gt;Team dinner after a long day in the lakes&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Another quick stop south of Preston for some roadside words of encouragement from another of my Jet2 colleagues before we were hit with heavy rain again in Warrington.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;By now, we were midway through the third day and the 560 or so miles in the legs over the past few days were starting to take their toll. I was starting to run on empty. Completely sick of gels and carbohydrate powder. Welcome relief came via a midnight pit stop in McDonalds. We contemplated a ‘ride-through’ but decided to treat ourselves to the luxury of a sit down for 30 mins. The staff look rather confused as we wobbled through the door, desperately trying to avoid skidding across the floor in our cycle cleats. Before leaving someone asked us where we had cycled from and gave the most perplexed face followed by some words of encouragement: “good on ya lads, keep it going”. After our fast food binge, we headed off into the rain, finally making our stop for the night just south of Crewe at 3am.&lt;/p&gt;
&lt;p&gt;Day 3 complete. 190 miles in 15 hours. Average speed: 15mph.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="day-4-crewe-to-lands-end-the-final-push"&gt;
&lt;h2&gt;Day 4 - Crewe to Lands End - the final push!&lt;/h2&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/screen-shot-2016-11-04-at-10-34-491.png" /&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A very slow start for me this morning, I could barely eat my breakfast. On reflection I think I put a bit too much effort in riding with the Manchester boys the previous day! We were soon back on the road and enjoying some fast country lanes through Cheshire and Staffordshire, a mixture of rather busy dual carriageways and some city navigation led us to our lunch spot just south of Worcester. Bikes serviced and lots of food consumed we set off towards Bristol, navigating a busy Gloucester rush hour on the way. The hills in Bristol came as a nasty surprise, which was quickly rectified by a nice stop at Pete's friend Mel's house for some lovely homemade flapjack! Then a quick 8 mile sprint to our dinner stop just south of Bristol.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Whilst unpleasant, todays dual carriageways did allow us to ride at a decent pace for a sustained period of time. Today was certainly the flattest section of riding we had done for a while and the legs were very much in need of it. The drafting with the Manchester boys the day before had helped to replenish my legs to an extent and today I was tired but strangely more comfortable on the bike than the first two days in fact.&lt;/p&gt;
&lt;p&gt;We made our way through Gloucester city centre just as the light was beginning to fade. By 8pm, we had passed through Bristol and over the clifton suspension bridge. A few miles out of the city we stopped off at my friend Mel's house - she had kindly baked flapjacks ready and waiting for our arrival. Those that didn’t get consumed were stuffed in any available jersey pockets. Whilst at Mel's I got to say a hello to 3 week old Thomas!&lt;/p&gt;
&lt;p&gt;A quick charge of the lights at Mel’s and we were off again. Less than an hours riding till designated stop for dinner. By the time we’d eaten we had 10 hours remaining to get to Lands End in under 4 days. We weren’t going to make our sub 4 day target. Despite this, we were still on for a good time, and bike ride aside I was working on Friday &amp;nbsp;so we had to get finished by Thursday! &amp;nbsp;On the cycle to dinner Jon and I concluded that an all-nighter was going to be the only way to make up the time.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;A quick dinner then back on the road at midnight. A crisp clear sky with calm winds allowed us to fire through Somerset very quickly, stopping in a rather delirious state of tiredness at two identical Budgen service stations. &amp;nbsp;A long drag of a climb brought us into Tiverton at 5am. We stopped for a snack in the 24 hour Tesco, where we were greeted by extremely friendly night staff who made us a cup of tea and went to fetch the famous cat ‘Mango’ that lives in the store for a team photo with us! Very odd, but very funny, it was good to be back in Devon!&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2435-jpg1.png" /&gt;
&lt;p class="caption"&gt;5am photograph with social media tycoon Mango the cat&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The cycle through the night was both a mental and physical battle. Neither of our lights had sufficient charge to make it through the whole night so we had to ration the available resources between us by alternating who had their lights dimmed to conserve battery life. Visibility was reduced to a few metres, and the conversation between us dissipated.&lt;/p&gt;
&lt;p&gt;We made a few pit stops along the route between Somerset to Devon. The two Budgens services provided an opportunity for a quick break and caffeination for the nights riding. By the time we’d reached our third pit stop at the 24 hour Tesco in Tiverton, I could only manage to sit in the middle of the shop floor, whilst the kind staff provided us with tea from their canteen.&lt;/p&gt;
&lt;p&gt;As we approached 3am the temperatures plummeted and it became harder and harder to get going after the mini breaks. For the first time in the whole ride I was desperate for a hill to come along so I could warm up.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2434-jpg.png" /&gt;
&lt;p class="caption"&gt;Trying to hold it together in Tesco&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;It was not long before my desire for hills would be fulfilled, over fulfilled in fact. We crossed the border to Devon just before 5am and to greet us were a set of climbs that were not to be sniffed at. These hills&amp;nbsp;would have posed a serious challenge on a casual Saturday afternoon jaunt, let alone in the state we were in! Because it was still pitch black at this time, the winding descents were just as much of a challenge due to fear of hitting potholes in the dark. Both our bodies were beginning to breakdown &amp;nbsp;- Jon and I were both suffering with sore knees amongst numerous other aches and pains which would occasionally result in an unannounced howl of: &amp;quot;aaarrgggghhhhh&amp;quot; as loud as possible in a bid to inform the other that we were 'feeling it'.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After Tiverton, the real test began. We were faced with horrific never ending 15 percent gradient climbs up to Crediton, where the temperature severely dropped, the fog rolled in and the rush hour traffic started. We were not in a happy place. It was so cold and we were stopping and starting with some mechanical issues with Pete's bike, I managed to strain my quad, which added further to our woes. Severe hill after severe hill followed before we finally made it to civilisation and a lovely clear morning in Okehampton. We pulled into Waitrose for a hit of caffeine, ibuprofen and sweet pastry treats.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2436-jpg1.png" /&gt;
&lt;p class="caption"&gt;Faces saying it all in Okehampton Waitrose after the all-nighter from Bristol&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;Next up was the fabled A30, the main dual carriageway running from Exeter to Lands End. It is renowned amongst 'End to Enders' as it is by far the quickest route through Cornwall, cutting out all the very hilly country lanes akin to those we had experienced in Devon, but being a dual carriageway it is far from ideal for cyclists. Most people start at Lands End in the evening so that they can tackle the A30 during the quiet night time. We were about to hit it at 9:30am! &amp;nbsp;We were riding in a foot wide hard shoulder which was littered with rocks, glass and road kill, which inevitably led to our first roadside punctures, two in fact! We were able to meet the van for the second puncture repair where a kind local man, whose driveway we had blocked-leant us some tools, donated to our charity and gave us a great A30 avoiding shortcut, welcome to Cornwall!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I don’t ever want to cycle on the A30 again. Despite being a fast route into the south west, &amp;nbsp;cars drive on it at&amp;nbsp;motorway speeds, probably because the M5 runs straight into it. The side section of the road was narrow and full of rubble, cat eye reflectors and even dead animals. At one point I found myself having to bunny hop the bike over a dead badger. Thankfully after a 15 mile or so stint on the A30 we reached Launceston and&amp;nbsp;broke off for quieter roads for 20 miles to avoid roadworks.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Our diversion from the A30 north towards Wadebridge, gave us much quieter roads, beautiful weather and lovely scenery of the north Cornish coast.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Finally, for the last part of the ride, we were blessed with some nice conditions, tailwind and sun shining. We were soon both overheating with our winter gear on. On into Cornwall and it felt like there was a light at the end of the tunnel. Much like Devon, the hills were a challenge but made all the more bearable by the fact that we didn’t have much further to go.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_20161020_145415003-jpg.png" /&gt;
&lt;p class="caption"&gt;Cornwall&lt;/p&gt;
&lt;/div&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2444-jpg.png" /&gt;
&lt;p class="caption"&gt;Last stop at the camper before the finish - about 80 miles to go&lt;/p&gt;
&lt;/div&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2445-jpg.png" /&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The backend of the A30 that we rejoined was more bearable than before due to better quality roads. Each mile of the 35 mile dual carriageway stint felt like an hour as we clawed our way to the finish. Signs for Penzance appeared and we both believed Lands End to be only 4 or 5 miles from there. Sadly once we reached Penzance it appeared that we would have another 10 miles ahead of us. These would be the longest 10 miles of the whole trip. The winding road into Lands End is full of super steep hills, and we were both reaching breaking point. As the sun began to set as we kept mistaking Lands End in the distance only to realise that we had a few more arduous miles to endure before we would be done.&lt;/p&gt;
&lt;p&gt;The relief to see both sets of parents waiting at the finish was incredible. I couldn’t quite believe it was finally over and we’d done it.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;After our deviations off the A30, it wasn't long before we were back on it, this time in the evening rush hour making our final push into the setting sun for Lands End. 35 miles of dual carriageway riding later and we eventually dropped into Penzance, with lovely views of St Michaels mount. The last 10 miles took forever, with several punishing hills remaining to completely finish us off! We pulled into Lands End at 19:11 on Thursday where we were welcomed home by both sets of parents, a moment we were both looking forward to for quite some time!&lt;/p&gt;
&lt;p&gt;Day 4 complete 334 miles in 33 hours 47 minutes. Average speed 14.5&lt;/p&gt;
&lt;p&gt;Mission complete - total distance 870 miles in 85 hours 26 minutes (technically less than 4 days out on the bikes) overall average speed 14.4mph.&lt;/p&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2451-jpg.png" /&gt;
&lt;p class="caption"&gt;Made it!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2448-jpg.png" /&gt;
&lt;/div&gt;
&lt;div class="figure align-center" style="width: 70%"&gt;
&lt;img alt="" src="https://peterwooldridge.me/img_2452-jpg.png" /&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Jon&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Thank you all for all your support, especially to my parents for doing such a great job looking after us on this epic challenge! We've done a great job raising a huge amount of money for our charity Diabetes UK, so thank you all for your donations along the way!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pete&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Thank you so much to everyone who supported us and helped raise money for Diabetes UK, a cause very close to my heart. A huge thank you is also in order to Jon's parents for all the cooking, cleaning, clothes drying, tea making, bike fixing and generally supporting us along the way - we couldn't have done it without you!&lt;/p&gt;
&lt;p&gt;Jon and Pete - resting up for a few days!&lt;/p&gt;
&lt;/div&gt;
</content><category term="endurance"></category></entry></feed>